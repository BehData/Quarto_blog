{
  "hash": "1db862843f6a6ba40ba24d71cddabb73",
  "result": {
    "markdown": "---\ntitle: 'Working Memory, Mathematical Anxiety'\nauthor: \"Jorge Huanca\"\ndate: '2023-03-12'\ncategories: ['Multiple linear regression','Math Anxiety']\nimage: \"image/image_jorge.jpg\"\ndescription: 'Search the determinants of math performance'\n---\n\n\n### Step 1: Install and load the packages\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(\"broom\",\"ggpubr\",\"tidyverse\",\"readr\")\n```\n:::\n\n\n### Step 2: Load the data into R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the database\ndata_math <- read.csv(\"data/WMAth data.csv\")\n```\n:::\n\n\n### Step 3: Explore outcome variable (must be numeric)\n\nWe checked if the independient variables (VI) are numeric\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(data_math)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 116\nColumns: 8\n$ age         <int> 42, 23, 23, 21, 23, 22, 31, 24, 27, 23, 27, 24, 25, 26, 24…\n$ Opposites   <int> 19, 31, 29, 29, 31, 31, 37, 44, 66, 56, 40, 30, 19, 28, 46…\n$ Nspan       <int> 27, 48, 40, 46, 46, 42, 41, 46, 47, 38, 41, 32, 38, 46, 42…\n$ Colors      <int> 5, 9, 6, 9, 9, 7, 6, 5, 11, 10, 3, 7, 11, 7, 14, 8, 12, 7,…\n$ PSWQ        <int> 49, 53, 77, 74, 51, 49, 64, 28, 69, 43, 52, 53, 41, 54, 38…\n$ MARS        <int> 89, 53, 95, 109, 80, 92, 121, 47, 102, 67, 81, 108, 116, 6…\n$ Fluency     <int> 101, 151, 120, 119, 115, 112, 83, 154, 155, 104, 148, 90, …\n$ Calculation <int> 18, 33, 36, 29, 33, 23, 16, 40, 27, 32, 31, 20, 29, 35, 28…\n```\n:::\n\n```{.r .cell-code}\n#Independent variables\n#Opposites: Verbal Working Memory\n#Nspan: Verbal Working Memory\n#Colors: Visuospatial Working Memory\n#PSWQ:The Penn State Worry Questionnaire, 16-item, 1-5 Likert  \n#MARS:The mathematical anxiety rating scale, 30-item, 0-4 Likert \n#Dependent variables\n#Fluency:Math Performance Assessment.\n#Calculation:Math Performance Assessment.\n```\n:::\n\n\n### Step 4: Make sure data assumptions\n\n#### A. Linearity\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Influence of Working Memory\nplot(Calculation ~ Opposites + Nspan + Colors, data = data_math)\n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Influence of Math Anxiety\nplot(Fluency + Calculation ~ MARS + PSWQ, data = data_math)\n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-5-5.png){width=672}\n:::\n:::\n\n\n#### B. Independence of observations\n\nTeoricamente se entiende que las variables son independientes\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\n#correlation\ncor(data_math$Calculation, data_math$MARS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4866136\n```\n:::\n\n```{.r .cell-code}\ncor(data_math$Calculation, data_math$Opposites)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3959613\n```\n:::\n\n```{.r .cell-code}\ncor(data_math$Calculation, data_math$Nspan)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3183924\n```\n:::\n\n```{.r .cell-code}\n#variance inflation factor\nvif(m_rendimiento_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     MARS Opposites     Nspan \n 1.110124  1.105262  1.169471 \n```\n:::\n:::\n\n\n#### C. Normality\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Independent variables\n#Verbal Working Memory\nhist(data_math$Opposites) \n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(data_math$Nspan)\n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Math Anxiety\nhist(data_math$MARS)\n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#Independent variables\nhist(data_math$Fluency)\n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-8-4.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(data_math$Calculation)\n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-8-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# Se puede evaluar la normalidad por  QQplot, Kurtosis\n```\n:::\n\n\n### Step 5: Perform the linear regression analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_rendimiento_lm <- lm(Calculation ~ MARS + Opposites + Nspan, data = data_math)\nsummary(m_rendimiento_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Calculation ~ MARS + Opposites + Nspan, data = data_math)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-14.6986  -4.7717  -0.6258   4.5865  19.0717 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 26.80750    4.04794   6.622 1.28e-09 ***\nMARS        -0.11188    0.02265  -4.940 2.75e-06 ***\nOpposites    0.19403    0.05426   3.576 0.000516 ***\nNspan        0.10409    0.07362   1.414 0.160182    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.982 on 112 degrees of freedom\nMultiple R-squared:  0.3448,\tAdjusted R-squared:  0.3273 \nF-statistic: 19.65 on 3 and 112 DF,  p-value: 2.642e-10\n```\n:::\n:::\n\n\n### Step 6: Check the homocedasticity\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2))\nplot(m_rendimiento_lm)\n```\n\n::: {.cell-output-display}\n![](jorge_regression_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow=c(1,1))\n```\n:::\n\n\n### Step 7: Perform a graph to visualize the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(m_rendimiento_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Calculation ~ MARS + Opposites + Nspan, data = data_math)\n\nCoefficients:\n(Intercept)         MARS    Opposites        Nspan  \n    26.8075      -0.1119       0.1940       0.1041  \n```\n:::\n\n```{.r .cell-code}\n# Get the Intercept and coefficients as vector elements.\ncat(\"# # # # The Coefficient Values # # # \",\"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# # # # The Coefficient Values # # #  \n```\n:::\n\n```{.r .cell-code}\na <- coef(m_rendimiento_lm)[1]\nprint(a)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept) \n    26.8075 \n```\n:::\n\n```{.r .cell-code}\nXedad <- coef(m_rendimiento_lm)[2]\nXprom <- coef(m_rendimiento_lm)[3]\nprint(Xedad)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      MARS \n-0.1118795 \n```\n:::\n\n```{.r .cell-code}\nprint(Xprom)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOpposites \n0.1940296 \n```\n:::\n:::\n",
    "supporting": [
      "jorge_regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}